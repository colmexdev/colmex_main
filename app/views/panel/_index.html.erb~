<% if admin_signed_in? %>

<p id="notice"><%= notice %></p>

<h1>Listado de <%= params[:set] %></h1><br>

<% if false %>
<a class="uk-link" onclick="hideLink(event,'#index-panel','<%= panel_nuevo_path(:set => params[:set]) %>')">Nuevo elemento</a>
<% end %>
<table id="index-panel">
  <thead>
    <tr id="header-ind">
			<% @fields.values.each do |f| %>
			<td class="head-ind"><%= f %></td>
			<% end %>
			<% @imgs.values.each do |f| %>
			<td class="head-ind"><%= f %></td>
			<% end %>
			<td class="head-ind-img" style="width:130px;"></td>
    </tr>
  </thead>

  <tbody style="font-size:14px;">
    <% @set.each do |s| %>
      <tr class="row-ind">
				<% @fields.keys.each do |f| %>
        <td class="ind-cell"><%= raw(s[f.to_s]) %></td>
				<% end %>
				<% @imgs.keys.each do |f| %>
					<% if f.to_s == "foto" %>
						<td class="ind-cell"><%= image_tag(s.foto.url) %></td>
					<% elsif f.to_s == "imagen" %>
						<td class="ind-cell"><%= image_tag(s.imagen.url) %></td>
					<% elsif f.to_s == "icono" %>
						<td class="ind-cell"><%= image_tag(s.icono.url) %></td>	
					<% elsif f.to_s == "badge" %>
						<td class="ind-cell"><%= image_tag(s.badge.url) %></td>	
					<% elsif f.to_s == "badge_eng" %>
						<td class="ind-cell"><%= image_tag(s.badge_eng.url) %></td>	
					<% elsif f.to_s == "archivo" %>
						<td class="ind-cell"><%= link_to image_tag("documento.png"), s.archivo.url, target: "_blank" %></td>
					<% end %>
				<% end %>
				<td class="ind-cell-img" style="width:130px;">
					<a class="link-img-panel" onclick="hideLink(event,'#index-panel','<%= panel_mostrar_path(:set => params[:set], :id => s.id) %>')"><span class="clickable-g glyphicon glyphicon-eye-open"></span></a>
					<a class="link-img-panel" onclick="hideLink(event,'#index-panel','<%= panel_editar_path(:set => params[:set], :id => s.id) %>')"><span class="clickable-g glyphicon glyphicon-pencil"></span></a>
					<a class="link-img-panel" onclick="hideLink(event,'#index-panel','<%= panel_eliminar_path(:set => params[:set], :id => s.id) %>','DELETE')"><span class="clickable-g glyphicon glyphicon-trash"></span></a>
				</td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>
<% if false %>
<a class="uk-link" onclick="hideLink(event,'#index-panel','<%= panel_princ_path %>')">Inicio</a>
<% end %>

<script type="text/javascript">
	var cols = $(".head-ind").length;
	$(".head-ind").each(function(index){
		$(this).css({"width": adjustWidths(cols), "text-align": "center", "font-weight": "500","font-size": "16px"}).css('width',('-='+(130/cols)+'px'));
	});
	$(".ind-cell").each(function(index){
		if(this.innerHTML.length > cols*90){
			var n_html = this.innerHTML.substring(0,cols*90) + "..."
			this.innerHTML = n_html;
		}
	});
</script>
<% end %>
